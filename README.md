# 概要
セキュリティ知識強化の一環として、段階的に機能を拡張していくPythonを使用した簡易的な自作EDRの記録です。徐々に機能を増やして実用的にしていくことを目標にしています。

## 実装した機能（随時更新中）
- ファイルの更新日時（mtime）に加えて、SHA-256ハッシュ値を比較して変更を検知。
- `config.json`で設定を一元化し、複数ファイルを同時監視可能。
- WindowsイベントログのEvent ID 4663からファイルを変更したユーザー、実行ファイルパス、プロセスID、編集されたファイルパスを特定。
- ファイル削除、再作成といったバイパスを検知可能（イベントログは出ない可能性あり）。
- PythonでWindowsイベントログを検索しているため、自分自身の処理をスキップしてFalse Positiveを低減。
- OSのログ書き込み遅延を考慮し、複数回試行して取りこぼしを防止。

## 注意点
※OS監査ポリシーの有効化と対象ファイルのSACLが必要。

## 今後実装予定
- 封じ込め
- プロセス停止
- Sysmonを利用し、カーネルフックに近い検知